<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title> Implementing a Protocol - Writing a ProtocolProviderFactory | Jitsi</title>
  <meta http-equiv='Content-Style-Type' content='text/css' />
  <link rel="shortcut icon" href="../wiki/pub/skins/simple/i/favicon.ico" type="image/x-icon">
  <link rel="icon" href="../wiki/pub/skins/simple/i/favicon.ico" type="image/x-icon">
  <link href='https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>
  <!-- link rel='stylesheet' href='https://desktop.jitsi.org/wiki/pub/skins/simple/pmwiki.css' type='text/css' / -->
  <link rel='stylesheet' href='../wiki/pub/skins/simple/simple.css' type='text/css' />
  <!--[if IE 6]><link type="text/css" rel="stylesheet" href="css/ie6.css" /><![endif]-->
  <!--HTMLHeader--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .apprlink { font-size:smaller; }
span.anchor {
	float: left;
	font-size: 10px;
	margin-left: -10px;
	width: 10px;
    position:relative; top:-0.1em;
	text-align: center;
}
span.anchor a { text-decoration: none; }
span.anchor a:hover { text-decoration: underline; }
ol.toc { text-indent:-20px; list-style: none; }
ol.toc ol.toc { text-indent:-40px; }
div.tocfloat { font-size: smaller; margin-bottom: 10px;
    border-top: 1px dotted #555555; border-bottom: 1px dotted #555555;
    padding-top: 5px; padding-bottom: 5px; 
    width: 38%; float: right; margin-left: 10px; clear: right;
    margin-right:-13px; padding-right: 13px; padding-left: 13px;
    background-color: #eeeeee; }
div.toc { font-size: smaller; 
    padding: 5px; border: 1px dotted #cccccc;
    background: #f7f7f7;
    margin-bottom: 10px; }
div.toc p { background-color: #f9f6d6;
    margin-top:-5px;   padding-top: 5px;
    margin-left:-5px;  padding-left: 5px;
    margin-right:-5px; padding-right: 5px;
    padding-bottom: 3px;
    border-bottom:  1px dotted #cccccc; }
div.breaklist { text-align: right; }
div.breaklist strong { background-color: yellow; }
div.breakpage { text-align: right; }.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/* GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter) */
.java  {font-family: monospace;}
.java .imp {font-weight: bold; color: red;}
.java .kw1 {color: #7F0055; font-weight: bold}
.java .kw2 {color: #7F0055; font-weight: bold;}
.java .kw3 {color: #aaaadd; font-weight: bold;}
.java .kw4 {color: #993333;}
.java .co1 {color: #3F7F5F; font-style: italic;}
.java .co2 {color: #a1a100;}
.java .coMULTI {color: #3F7F5F; font-style: italic;}
.java .es0 {color: #000099; font-weight: bold;}
.java .br0 {color: #666;}
.java .st0 {color: #2A00FF;}
.java .nu0 {color: #cc66cc;}
.java .me1 {color: #666;}
.java .me2 {color: #666;}

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  border: 1px solid #808080;
  background-color: #f1f0ed;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript">
function toggle(obj) {
    var elstyle = document.getElementById(obj).style;
    var text    = document.getElementById(obj + "tog");
    if (elstyle.display == 'none') {
        elstyle.display = 'block';
        text.innerHTML = "hide";
    } else {
        elstyle.display = 'none';
        text.innerHTML = "show";
    }
}
</script><link rel='stylesheet' href='../wiki/pub/css/markup.css' type='text/css' />

  <link href='../wiki/pub/commentboxplus/commentboxplus.css' rel='stylesheet' type='text/css' />  <meta name='robots' content='index,follow' />

<!-- google analytics tracker -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-319188-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- end google analytics tracker -->

<script type="text/javascript">
	<!--//--><![CDATA[//><!--
    startList = 
    	function() 
        {
        	if (document.all && document.getElementById) {
            	navRoot = document.getElementById("menu");
                for (i = 0; i < navRoot.childNodes.length; i++) {
                	node = navRoot.childNodes[i];
                    if (node.nodeName == "LI") {
                    	node.onmouseover = 
                        	function() { this.className += " over"; }
                        node.onmouseout = 
                        	function() { this.className = this.className.replace(" over", ""); }
                    }
                }
            }
        }
	window.onload = startList;
    //--><!]]>
</script>

<script language="JavaScript1.1">
<!--
	first = 1;
    last = 5;
    current = 0;
    var slideTimerId = 0;
	var buttonLink = "";
    var osName="Unknown OS";
            
    function nextPicture()
	{
	    removeCurrent();

	    // Show next picture, if last, loop back to front
    	if (current == last) { current = 1; }
        else { current++ }

		addCurrent();
		
		restartTimer();	
	}

    function previousPicture()
	{
		removeCurrent();

        if (current == first) { current = last; }
        else { current--; }
        
		addCurrent();

		restartTimer();	
	}
	
	function goToSlide(index)
	{         
		removeCurrent();

        current = index;

        addCurrent();

		restartTimer();	
	}
	
	function removeCurrent()
	{
		if (current != 0)
		{
	    	// Hide current picture
    	    object = document.getElementById('slide' + current);
        	object.style.display = 'none';
 
			fade('slide' + current);

            object = document.getElementById('dot' + current);
	        object.style.backgroundImage = "url(https://desktop.jitsi.org/wiki/pub/sip-communicator/dot.png)";
		}
	}
	
	function addCurrent()
	{
		object = document.getElementById('slide' + current);
		object.style.opacity = 0;
        object.style.display = 'block';

        fade('slide' + current);

		object = document.getElementById('dot' + current);
        object.style.backgroundImage = "url(https://desktop.jitsi.org/wiki/pub/sip-communicator/dotSelected.png)";
	}

	function restartTimer()
	{
		clearTimeout(slideTimerId);
		slideTimerId = setTimeout("slideit()", slideshowspeed);
	}

	var TimeToFade = 500.0;

	function fade(eid)
	{
	  	var element = document.getElementById(eid);
  		if(element == null)
    		return;
   
  		if(element.FadeState == null)
  		{
    		if(element.style.opacity == '1')
		    {
      			element.FadeState = 2;
    		}
    		else if (element.style.opacity == null
					|| element.style.opacity == '0'
					|| element.style.opacity == '')
    		{
      			element.FadeState = -2;
    		}
  		}
    
  		if(element.FadeState == 1 || element.FadeState == -1)
  		{
    		element.FadeState = element.FadeState == 1 ? -1 : 1;
    		element.FadeTimeLeft = TimeToFade - element.FadeTimeLeft;
  		}
  		else
  		{
    		element.FadeState = element.FadeState == 2 ? -1 : 1;
    		element.FadeTimeLeft = TimeToFade;
    		setTimeout("animateFade(" + new Date().getTime() + ",'" + eid + "')", 33);
  		}  
	}

	function animateFade(lastTick, eid)
	{  
  		var curTick = new Date().getTime();
		var elapsedTicks = curTick - lastTick;
  
  		var element = document.getElementById(eid);
 
  		if(element.FadeTimeLeft <= elapsedTicks)
  		{
    		element.style.opacity = element.FadeState == 1 ? '1' : '0';
    		element.style.filter = 'alpha(opacity = ' 
        		+ (element.FadeState == 1 ? '100' : '0') + ')';
	    	element.FadeState = element.FadeState == 1 ? 2 : -2;
		    return;
  		}
 
	  	element.FadeTimeLeft -= elapsedTicks;
  		var newOpVal = element.FadeTimeLeft/TimeToFade;
  		if(element.FadeState == 1)
	    	newOpVal = 1 - newOpVal;

  		element.style.opacity = newOpVal;
 	 	element.style.filter = 'alpha(opacity = ' + (newOpVal*100) + ')';
  
	  	setTimeout("animateFade(" + curTick + ",'" + eid + "')", 33);
	}
	
	function createCORSRequest(method, url)
	{
    	var xhr = new XMLHttpRequest();
	    if ("withCredentials" in xhr)
		{
    	    xhr.open(method, url, true);
	    }
		else if (typeof XDomainRequest != "undefined")
		{
        	xhr = new XDomainRequest();
        	xhr.open(method, url);
	    }
		else
		{
        	xhr = null;
    	}
    	return xhr;
	}

	function createDownloadText()
	{
		if (navigator.appVersion.indexOf("Win")!=-1)
			osName="Windows";
		if (navigator.appVersion.indexOf("Mac")!=-1)
			osName="Mac OS X";
		if (navigator.appVersion.indexOf("X11")!=-1)
			osName="Unix";
		if (navigator.appVersion.indexOf("Linux")!=-1)
			osName="Linux";
		
		return "Get Jitsi for " + osName;
	}

	function getOsName()
	{
	    var os = "";
		if (navigator.appVersion.indexOf("Win")!=-1)
			os="windows";
		if (navigator.appVersion.indexOf("Mac")!=-1)
			os="macosx";
		if (navigator.appVersion.indexOf("Linux")!=-1)
			os="linux";
		
		return os;
	}

	function getDownloadURL()
	{
	    var url = "";
		if (navigator.appVersion.indexOf("Win")!=-1)
			url="https://download.jitsi.org/nightly/windows/";
		if (navigator.appVersion.indexOf("Mac")!=-1)
			url="https://download.jitsi.org/nightly/macosx/";
		if (navigator.appVersion.indexOf("Linux")!=-1)
			url="https://download.jitsi.org/nightly/linux/";
		
		return url;
	}

    function createDownloadLink()
	{
		var txtFile = createCORSRequest("get", getDownloadURL() + "versionupdate.properties");
        txtFile.onreadystatechange = function()
        {
            if (txtFile.readyState == 4)
            {  // Makes sure the document is ready to parse.
				display_all(txtFile.responseText);
                buttonLink = getDownloadURL() + txtFile.responseText;
            }
        }
        txtFile.send();
	}

	function display_column(str_line, n)
	{
   		document.write("<p>" + str_line.split('\t')[n - 1]);
	}

	function display_all(data)
	{
   		var i, x = data.split('\n');
	   	for (i = 0; i < data.length; i++)
		{
      		display_column(data[i], 1);
	      	// it's 1 because you only want to display the 1st column..
      		// unless I misunderstood your question..
   		}
	}

	function download()
	{
		window.open(buttonLink);
	}
//-->
</script>
<noscript>
    <style>
        #slideshow {display:none;}
    </style>
</noscript>

</head>
<body class="Implementing a Protocol - Writing a ProtocolProviderFactory" style="background-image: none">
<div id="meet-banner" style="background-color: #1d76ba;">
    <p style="color: #fff; padding: 20px;">
        If you are looking for Jitsi Meet, the WebRTC compatible video conferencing product click <a href="https://jitsi.org">here</a>.
    </p>
</div>
<!--PageHeaderFmt-->
  	<div id="wrapper">
		<div id="header">
			<!--ul id="headernavigation">
						<li class="left"><a href="#">Sitemap</a></li>
						<li><a href="#">Contact</a></li>
						<li class="search"><form action='https://desktop.jitsi.org' style="padding:0; margin:0"><input type='hidden' name='n' value='Documentation.HowToImplementProtocols4' /><input type='hidden' name='action' value='search' /><input type="text" name="q" onblur="if(this.value=='')this.value='Search...';" onfocus="if(this.value=='Search...')this.value=''" value="Search..." class="text" /><input type="submit" value="" class="submit"/></form></li>
			</ul--> 
	   <div id="menubar" style="display: block;">
				<div> 
			      	<span>
				    	<a href='https://desktop.jitsi.org/Documentation/HowToImplementProtocols4?action=edit' accesskey='e' style="display: none;">>Edit Page</a>
		    			
			        </span>
				</div> 
     			<div class="clear"></div>

        </div>
						
		<div id="logo">
			<a href="../index.html">
				<img  src="../wiki/pub/sip-communicator/logo3.png" />
			</a>
		</div>		
		
        <div id="menu" style="display: block;">	
	       
            <span id="popupmenu" style="float: left;">
			    <ul id="navigation">
            		<li class="first" id="Main"><a class="mainmenu"><span>Jitsi</span></a>
                    	<ul><li><a class='wikilink' href='../Main/HomePage.html'>Home</a>
</li><li><a class='wikilink' href='../Main/News.html'>News</a>
</li><li><a class='wikilink' href='../Main/Download.html'>Download</a>
</li><li><a class='wikilink' href='../Main/Screenshots.html'>Screenshots</a>
</li><li><a class='wikilink' href='../Main/Features.html'>Features</a>
</li><li><a class='wikilink' href='../Main/About.html'>About</a>
</li></ul>
 
                    </li>                     
	               	<li id="Download"><a class="mainmenu" href="../Main/Download.html"><span>Download</span></a>
						

					</li>
                    <li id="Development"><a class="mainmenu"><span>Development</span></a>
                    	<ul><li><a class='wikilink' href='../Development/CommunityForum.html'>Commmunity Forum</a>
</li><li><a class='wikilink' href='../Development/VersionControl.html'>Source Code</a>
</li><li><a class='wikilink' href='../Development/TeamAndContributors.html'>Team and Contributors</a>
</li><li><a class='urllink' href='https://github.com/jitsi' rel='nofollow'>GitHub project page</a>
</li><li>Jitsi Family
</li><li><a class='urllink' href='https://jitsi.org/meet' rel='nofollow'>Jitsi Meet</a>
</li><li><a class='urllink' href='https://jitsi.org/libjitsi' rel='nofollow'>LibJitsi</a>
</li><li><a class='urllink' href='http://ice4j.org' rel='nofollow'>ice4j.org</a>
</li><li><a class='urllink' href='https://jitsi.org/jitsi-videobridge' rel='nofollow'>Jitsi Videobridge</a>
</li></ul>

					</li>
					<li id="Documentation"><a class="mainmenu"><span>Documentation</span></a>
						<ul><li><a class='wikilink' href='UserDocumentation.html'>User Documentation</a>
</li><li><a class='wikilink' href='DeveloperDocumentation.html'>Developer Documentation</a>
</li><li><a class='wikilink' href='FAQ.html'>FAQ</a>
</li><li><a class='wikilink' href='ZrtpFAQ.html'>ZRTP and SRTP FAQ</a>
</li></ul>

					</li>
				
					<!--li class="last" id="Support"><a class="mainmenu"><span>Support</span></a-->
	                 	<ul><li><a class='wikilink' href='../Commercial/Companies.html'>Support and Custom Development</a>
</li></ul>
	 					
					<!--/li-->
				</ul>
			</span>
			<div class="clear"></div>
		   </div>
		
        </div>
        
		<div id="content">
			 			<!--PageText-->
<div id='wikitext'>
<p><a class='wikilink' href='HowToImplementProtocols3.html'>previous</a> | <a class='wikilink' href='HowToImplementProtocols.html'>TOC</a> | <a class='wikilink' href='HowToImplementProtocols5.html'>next</a>
</p><div style='width:960px; margin:40px auto;text-align:left' >
<div id='separator' >
</div><div >
<div class='vspace'></div><h1>Implementing a Protocol</h1>
</div><div id='subttl' >
<p>Writing a ProtocolProviderFactory
</p></div>
<p class='vspace'>A ProtocolProviderFactory implementation is the class that creates protocol providers. Jitsi needs to create one protocol provider instance per user account. It will do so through the installAccount() method of ProtocolProviderFactoryGibberishImpl. Any factory must be extending the ProtocolProviderFactory abstract class.
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=1.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="kw2">public</span> AccountID installAccount<span class="br0">&#40;</span> <a href="http://www.google.com/search?q=allinurl%3AString+java.sun.com&amp;bntl=1"><span class="kw3">String</span></a> userIDStr,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.google.com/search?q=allinurl%3AMap+java.sun.com&amp;bntl=1"><span class="kw3">Map</span></a> accountProperties<span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; BundleContext context<br />
&nbsp; &nbsp; &nbsp; &nbsp; = GibberishActivator.<span class="me1">getBundleContext</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>context == <span class="kw2">null</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">throw</span> <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3ANullPointerException+java.sun.com&amp;bntl=1"><span class="kw3">NullPointerException</span></a><span class="br0">&#40;</span><span class="st0">&quot;The specified BundleContext was null&quot;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>userIDStr == <span class="kw2">null</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">throw</span> <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3ANullPointerException+java.sun.com&amp;bntl=1"><span class="kw3">NullPointerException</span></a><span class="br0">&#40;</span><span class="st0">&quot;The specified AccountID was null&quot;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>accountProperties == <span class="kw2">null</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">throw</span> <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3ANullPointerException+java.sun.com&amp;bntl=1"><span class="kw3">NullPointerException</span></a><span class="br0">&#40;</span><span class="st0">&quot;The specified property map was null&quot;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; accountProperties.<span class="me1">put</span><span class="br0">&#40;</span>USER_ID, userIDStr<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; AccountID accountID = <span class="kw2">new</span> GibberishAccountID<span class="br0">&#40;</span>userIDStr, accountProperties<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="co1">//make sure we haven't seen this account id before.</span><br />
&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>registeredAccounts.<span class="me1">containsKey</span><span class="br0">&#40;</span>accountID<span class="br0">&#41;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">throw</span> <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3AIllegalStateException+java.sun.com&amp;bntl=1"><span class="kw3">IllegalStateException</span></a><span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;An account for id &quot;</span> + userIDStr + <span class="st0">&quot; was already installed!&quot;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="co1">//first store the account and only then load it as the load generates</span><br />
&nbsp; &nbsp; <span class="co1">//an osgi event, the osgi event triggers (through the UI) a call to the</span><br />
&nbsp; &nbsp; <span class="co1">//ProtocolProviderService.register() method and it needs to acces </span><br />
&nbsp; &nbsp; <span class="co1">//the configuration service and check for a stored password.</span><br />
&nbsp; &nbsp; <span class="kw2">this</span>.<span class="me1">storeAccount</span><span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; GibberishActivator.<span class="me1">getBundleContext</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; , accountID<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; accountID = loadAccount<span class="br0">&#40;</span>accountProperties<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw2">return</span> accountID;<br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>Note that the <em>installAccount</em> and <em>uninstallAccount</em> methods, have to be persistent. In other words, once our factory creates an account it needs to remain there even after we restart the application. To achieve this we use the <em>storeAccount()</em> and <em>removeStoredAccount()</em> methods that are defined in the abstract protocol provider factory itself.
</p>
<p class='vspace'>Accounts that we store through this <em>storeAccount()</em> method are going to be reloaded every time Jitsi is started until we remove them through <em>removeStoredAccount()</em>. 
</p>
<p class='vspace'>In the <em>installAccount()</em> method we are using a <em>loadAccount()</em> method that would actually instantiate the protocol provider service and register it in the OSGi bundle context so that it is available for other bundles. Every time we start Jitsi the <em>loadAccount()</em> method will be called for all stored accounts. Before seeing the method we&rsquo;ll define a hashtable where we&rsquo;ll be storing references to all accounts we&rsquo;ve created.
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=2.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="coMULTI">/**<br />
&nbsp;* The table that we store our accounts in.<br />
&nbsp;*/</span><br />
<span class="kw2">private</span> <a href="http://www.google.com/search?q=allinurl%3AHashtable+java.sun.com&amp;bntl=1"><span class="kw3">Hashtable</span></a> registeredAccounts = <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3AHashtable+java.sun.com&amp;bntl=1"><span class="kw3">Hashtable</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>;</div></div></div>
<p class='vspace'>and here&rsquo;s how the loadAccount() method itself looks for us.
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=3.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="kw2">public</span> AccountID loadAccount<span class="br0">&#40;</span> <a href="http://www.google.com/search?q=allinurl%3AMap+java.sun.com&amp;bntl=1"><span class="kw3">Map</span></a> accountProperties<span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; BundleContext context<br />
&nbsp; &nbsp; &nbsp; &nbsp; = GibberishActivator.<span class="me1">getBundleContext</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="kw1">if</span><span class="br0">&#40;</span>context == <span class="kw2">null</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">throw</span> <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3ANullPointerException+java.sun.com&amp;bntl=1"><span class="kw3">NullPointerException</span></a><span class="br0">&#40;</span><span class="st0">&quot;The specified BundleContext was null&quot;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <a href="http://www.google.com/search?q=allinurl%3AString+java.sun.com&amp;bntl=1"><span class="kw3">String</span></a> userIDStr = <span class="br0">&#40;</span><a href="http://www.google.com/search?q=allinurl%3AString+java.sun.com&amp;bntl=1"><span class="kw3">String</span></a><span class="br0">&#41;</span>accountProperties.<span class="me1">get</span><span class="br0">&#40;</span>USER_ID<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; AccountID accountID = <span class="kw2">new</span> GibberishAccountID<span class="br0">&#40;</span>userIDStr, accountProperties<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="co1">//get a reference to the configuration service and register whatever</span><br />
&nbsp; &nbsp; <span class="co1">//properties we have in it.</span><br />
<br />
&nbsp; &nbsp; <a href="http://www.google.com/search?q=allinurl%3AHashtable+java.sun.com&amp;bntl=1"><span class="kw3">Hashtable</span></a> properties = <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3AHashtable+java.sun.com&amp;bntl=1"><span class="kw3">Hashtable</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; properties.<span class="me1">put</span><span class="br0">&#40;</span>PROTOCOL, ProtocolNames.<span class="me1">JABBER</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; properties.<span class="me1">put</span><span class="br0">&#40;</span>USER_ID, userIDStr<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; ProtocolProviderServiceGibberishImpl gibberishProtocolProvider<br />
&nbsp; &nbsp; &nbsp; &nbsp; = <span class="kw2">new</span> ProtocolProviderServiceGibberishImpl<span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; gibberishProtocolProvider.<span class="me1">initialize</span><span class="br0">&#40;</span>userIDStr, accountID<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; ServiceRegistration registration<br />
&nbsp; &nbsp; &nbsp; &nbsp; = context.<span class="me1">registerService</span><span class="br0">&#40;</span> ProtocolProviderService.<span class="kw2">class</span>.<span class="me1">getName</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;gibberishProtocolProvider,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;properties<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; registeredAccounts.<span class="me1">put</span><span class="br0">&#40;</span>accountID, registration<span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="kw2">return</span> accountID;<br />
<span class="br0">&#125;</span></div></div></div> 
<p class='vspace'>You&rsquo;ll probably get an error for the above code on the line containing the ProtocolProviderServiceGibberishImpl instantiation, since we have not yet created it. You could ignore or comment it for now and we&rsquo;ll get to it later.
</p>
<p class='vspace'>Now, in order to make sure that all stored accounts are loaded every time Jitsi starts, it is our responsibility to call the method that does this. Its name is  <em>loadStoredAccounts(BundleContext)</em> and it is implemented in the parent (abstract) protocol provider factory. It is however offering only <em>protected</em> access so we&rsquo;ll add a convenience method here in order to be able and call it when our activator is <em>start()</em>ing. Here&rsquo;s how this method looks:
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=4.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="coMULTI">/**<br />
&nbsp;* ...<br />
&nbsp;*/</span><br />
<span class="kw2">public</span> <span class="kw4">void</span> loadStoredAccounts<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; super.<span class="me1">loadStoredAccounts</span><span class="br0">&#40;</span> GibberishActivator.<span class="me1">getBundleContext</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>A protocol provider factory is also responsible for removing existing protocol providers. In its <em>uninstallAccount()</em> method it would close a correspnding protocol provider and remove its service registration from the OSGi bundle context. For our <em>Gibberish</em> protocol this would give us:
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=5.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="kw2">public</span> <span class="kw4">boolean</span> uninstallAccount<span class="br0">&#40;</span>AccountID accountID<span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; <span class="co1">//unregister the protocol provider</span><br />
&nbsp; &nbsp; ServiceReference serRef = getProviderForAccount<span class="br0">&#40;</span>accountID<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; ProtocolProviderService protocolProvider<br />
&nbsp; &nbsp; &nbsp; &nbsp; = <span class="br0">&#40;</span>ProtocolProviderService<span class="br0">&#41;</span> GibberishActivator.<span class="me1">getBundleContext</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="me1">getService</span><span class="br0">&#40;</span>serRef<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw2">try</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; protocolProvider.<span class="me1">unregister</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="br0">&#125;</span><br />
&nbsp; &nbsp; <span class="kw2">catch</span> <span class="br0">&#40;</span>OperationFailedException exc<span class="br0">&#41;</span> <span class="br0">&#123;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp; logger.<span class="me1">error</span><span class="br0">&#40;</span><span class="st0">&quot;Failed to unregister protocol provider for account : &quot;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + accountID + <span class="st0">&quot; caused by : &quot;</span> + exc<span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="br0">&#125;</span><br />
<br />
&nbsp; &nbsp; ServiceRegistration registration<br />
&nbsp; &nbsp; &nbsp; &nbsp; = <span class="br0">&#40;</span>ServiceRegistration<span class="br0">&#41;</span>registeredAccounts.<span class="me1">remove</span><span class="br0">&#40;</span>accountID<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw1">if</span><span class="br0">&#40;</span>registration == <span class="kw2">null</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw2">return</span> <span class="kw2">false</span>;<br />
<br />
&nbsp; &nbsp; <span class="co1">//kill the service</span><br />
&nbsp; &nbsp; registration.<span class="me1">unregister</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw2">return</span> removeStoredAccount<span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; GibberishActivator.<span class="me1">getBundleContext</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; , accountID<span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>Once again, ignore the error caused by the reference to the not yet defice ProtocolProviderService class.
</p>
<p class='vspace'>We have two more methods left to implement here: <em>getRegisteredAccounts()</em>, which would return a set over all the <em>AccountID</em>&rsquo;s that and getProviderForAccount() which returns a reference to a protocol provider corresponding to a specified <em>AccountID</em>. 
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=6.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="coMULTI">/**<br />
&nbsp;* ...<br />
&nbsp;*/</span><br />
<span class="kw2">public</span> ServiceReference getProviderForAccount<span class="br0">&#40;</span>AccountID accountID<span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; ServiceRegistration registration<br />
&nbsp; &nbsp; &nbsp; &nbsp; = <span class="br0">&#40;</span>ServiceRegistration<span class="br0">&#41;</span>registeredAccounts.<span class="me1">get</span><span class="br0">&#40;</span>accountID<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="kw2">return</span> <span class="br0">&#40;</span>registration == <span class="kw2">null</span> <span class="br0">&#41;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? <span class="kw2">null</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : registration.<span class="me1">getReference</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span><br />
<br />
<span class="coMULTI">/**<br />
&nbsp;* ...<br />
&nbsp;*/</span><br />
<span class="kw2">public</span> <a href="http://www.google.com/search?q=allinurl%3AArrayList+java.sun.com&amp;bntl=1"><span class="kw3">ArrayList</span></a> getRegisteredAccounts<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; <span class="kw2">return</span> <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3AArrayList+java.sun.com&amp;bntl=1"><span class="kw3">ArrayList</span></a><span class="br0">&#40;</span>registeredAccounts.<span class="me1">keySet</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>The complete source code for the Gibberish protocol provider factory is available <a class='urllink' href='https://sip-communicator.dev.java.net/source/browse/*checkout*/sip-communicator/trunk/src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolProviderFactoryGibberishImpl.java' rel='nofollow'>here</a>. You might also want to have a look at other factory implementations like for example <a class='urllink' href='https://sip-communicator.dev.java.net/source/browse/*checkout*/sip-communicator/trunk/src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderFactoryJabberImpl.java' rel='nofollow'>ProtocolProviderFactoryJabberImpl</a> and <a class='urllink' href='https://sip-communicator.dev.java.net/source/browse/*checkout*/sip-communicator/trunk/src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderFactorySipImpl.java' rel='nofollow'>ProtocolProviderFactorySipImpl</a>.
</p>
<p class='vspace'>Now that we are ready with our factory we&rsquo;ll add a few lines to the <em>GibberishActivator</em> so that it would export it as a service and load all stored accounts on startup. Here&rsquo;s how this happens: First in <em>GibberishActivator</em> we define two more fields corresponding to a reference to the factory and its service registration
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=7.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="kw2">private</span>&nbsp; &nbsp; &nbsp; &nbsp; ServiceRegistration&nbsp; gibberishPpFactoryServReg = <span class="kw2">null</span>;<br />
<span class="kw2">private</span> <span class="kw4">static</span> ProtocolProviderFactoryGibberishImpl<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gibberishProviderFactory&nbsp; = <span class="kw2">null</span>;</div></div></div>
<p class='vspace'>Exporting the service itself would happen in the <em>start()</em> method of the <em>GibberishActivator</em> and it would now look like this:
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=8.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="coMULTI">/**<br />
&nbsp;* ...<br />
&nbsp;*/</span><br />
<span class="kw2">public</span> <span class="kw4">void</span> start<span class="br0">&#40;</span>BundleContext context<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">throws</span> <a href="http://www.google.com/search?q=allinurl%3AException+java.sun.com&amp;bntl=1"><span class="kw3">Exception</span></a><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; <span class="kw2">this</span>.<span class="me1">bundleContext</span> = context;<br />
<br />
&nbsp; &nbsp; <a href="http://www.google.com/search?q=allinurl%3AHashtable+java.sun.com&amp;bntl=1"><span class="kw3">Hashtable</span></a> hashtable = <span class="kw2">new</span> <a href="http://www.google.com/search?q=allinurl%3AHashtable+java.sun.com&amp;bntl=1"><span class="kw3">Hashtable</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; hashtable.<span class="me1">put</span><span class="br0">&#40;</span>ProtocolProviderFactory.<span class="me1">PROTOCOL</span>, <span class="st0">&quot;Gibberish&quot;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; gibberishProviderFactory = <span class="kw2">new</span> ProtocolProviderFactoryGibberishImpl<span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="co1">//load all jabber providers</span><br />
&nbsp; &nbsp; gibberishProviderFactory.<span class="me1">loadStoredAccounts</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; <span class="co1">//reg the jabber account man.</span><br />
&nbsp; &nbsp; gibberishPpFactoryServReg =&nbsp; context.<span class="me1">registerService</span><span class="br0">&#40;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ProtocolProviderFactory.<span class="kw2">class</span>.<span class="me1">getName</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gibberishProviderFactory,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hashtable<span class="br0">&#41;</span>;<br />
<br />
&nbsp; &nbsp; logger.<span class="me1">info</span><span class="br0">&#40;</span><span class="st0">&quot;Gibberish protocol implementation [STARTED].&quot;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>We&rsquo;ve taken care about starting the bundle now let&rsquo;s see how we handle <em>stop()</em>-ing it. Inside <em>ProtocolProviderFactoryGibberishImpl</em> we add a very simple <em>stop()</em> method in which we unregister all services and remove them from our accounts table.
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=9.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="coMULTI">/**<br />
&nbsp;* Prepares the factory for bundle shutdown.<br />
&nbsp;*/</span><br />
<span class="kw2">public</span> <span class="kw4">void</span> stop<span class="br0">&#40;</span><span class="br0">&#41;</span><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; <a href="http://www.google.com/search?q=allinurl%3AEnumeration+java.sun.com&amp;bntl=1"><span class="kw3">Enumeration</span></a> registrations = <span class="kw2">this</span>.<span class="me1">registeredAccounts</span>.<span class="me1">elements</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="kw1">while</span><span class="br0">&#40;</span>registrations.<span class="me1">hasMoreElements</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; ServiceRegistration reg = <span class="br0">&#40;</span><span class="br0">&#40;</span>ServiceRegistration<span class="br0">&#41;</span>registrations.<span class="me1">nextElement</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; &nbsp; &nbsp; reg.<span class="me1">unregister</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="br0">&#125;</span><br />
<br />
&nbsp; &nbsp; <a href="http://www.google.com/search?q=allinurl%3AEnumeration+java.sun.com&amp;bntl=1"><span class="kw3">Enumeration</span></a> idEnum = registeredAccounts.<span class="me1">keys</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="kw1">while</span><span class="br0">&#40;</span>idEnum.<span class="me1">hasMoreElements</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; registeredAccounts.<span class="me1">remove</span><span class="br0">&#40;</span>idEnum.<span class="me1">nextElement</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; <span class="br0">&#125;</span><br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>Of course we&rsquo;d also need to call this method from the <em>GibberishActivator.stop()</em> method. Here&rsquo;s how we modify it:
</p>
<div class='vspace'></div><div class='sourceblock'>
<div class='sourceblocklink'><a href='HowToImplementProtocols4&amp;ref=10.html' type='text/plain'>[&#036;[Get Code]]</a></div><div class='sourceblocktext'><div class="java" style="font-family: monospace;"><span class="kw2">public</span> <span class="kw4">void</span> stop<span class="br0">&#40;</span>BundleContext context<span class="br0">&#41;</span><br />
&nbsp; &nbsp; <span class="kw2">throws</span> <a href="http://www.google.com/search?q=allinurl%3AException+java.sun.com&amp;bntl=1"><span class="kw3">Exception</span></a><br />
<span class="br0">&#123;</span><br />
&nbsp; &nbsp; <span class="kw2">this</span>.<span class="me1">gibberishProviderFactory</span>.<span class="me1">stop</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; gibberishPpFactoryServReg.<span class="me1">unregister</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;<br />
&nbsp; &nbsp; logger.<span class="me1">info</span><span class="br0">&#40;</span><span class="st0">&quot;Gibberish protocol implementation [STOPPED].&quot;</span><span class="br0">&#41;</span>;<br />
<span class="br0">&#125;</span></div></div></div>
<p class='vspace'>So much for the factory. In case you are missing something, don&rsquo;t hesitate to have a look at the real thing - our own <a class='urllink' href='https://sip-communicator.dev.java.net/source/browse/*checkout*/sip-communicator/trunk/src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolProviderFactoryGibberishImpl.java' rel='nofollow'>ProtocolProviderFactoryGibberishImpl</a>
</p>
<p class='vspace'><em>PENDING: Move the following to the account wizard chapter since it only concerns the wizard.</em>
The parent factory also provides methods for storing a user&rsquo;s password. These passwords are not securely stored (for now) so make sure that you only store them when the user has requested you to do so (the user credentials that you retrieved through a security authority had the persistentPassword property set to true).
</p>
<div class='vspace'></div><div id='separator' >
</div><div >
</div></div>
<p><a class='wikilink' href='HowToImplementProtocols3.html'>previous</a> | <a class='wikilink' href='HowToImplementProtocols.html'>TOC</a> | <a class='wikilink' href='HowToImplementProtocols5.html'>next</a>
</p>
</div>
	
			<div id="clear"></div>	
			
		</div>
		<div id="push"></div>
	</div>	
		<div id="footer">
			<div id="footerwrap"> 
			        
					<div class="fcleft">
							
							Jitsi is distributed under the terms of the Apache License, Version 2.0
						
					</div> 
					<!--div class="fccontact">
						<b>Contacts</b><br/>
						mail: contact@bluejimp.com<br/>
                        sip: bluejimp@ippi.fr <br/>
						phone France: +33 1 77 62 43 30<br/>
						phone USA: +1 415 762 0439
					</div>
					<div class="fccontact">
						<b>Head Office - France</b><br/>
						Strasbourg, France<br/><br/>
						phone: +33 1 77 62 43 30<br/>
						fax: +33 1 77 62 47 31
					</div>
					<div class="fccontact">
                        <b>Bulgarian Branch</b><br/>headernavigation
                        34 Nikolay Haitov Str.<br/>
                        1172 Sofia, Bulgaria<br/>
                        phone: +359 2 868 75 74<br/>
                        phone: +359 2 868 88 49 
                    </div-->
					<div class="fcright">
					   <div style="position:relative;z-index:3;width:367px;text-align:right;">					
					          Powered by: <a href="http://pmwiki.org" rel="external">pmwiki</a>
					   </div>	
					<!--	<div id="logoimage" >	
						    	  <img  src="https://desktop.jitsi.org/wiki/pub/sip-communicator/footerimage.png" />
						</div>-->			    					   
					</div>								
					</div>
				
										
			</div>

</body></html>
